codeWrite(exp):

if exp is a number n:
output "push n"

if exp is a variable var:
output "push var"

if exp is "exp 1 op exp 2":
codeWrite(exp 1),
codeWrite(exp 2),
output "op"

if exp is "op exp":
codeWrite(exp),
output "op"

if exp is "f(exp 1, exp 2, ...)":
codeWrite(exp 1),
codeWrite(exp 2), ...,
output "call f"

################

Compiling if statements:
if (expression)
statements1
else
statements2
...

compiled (expression)
not
if-goto L1
compiled (statements1)
goto L2
label L1
compiled (statements2)
label L2
...

Compiling while statements:
while (expression)
statements
...

label L1
compiled (expression)
not
if-goto L2
compiled (statements)
goto L1
label L2
...

